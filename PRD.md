### **产品需求文档 (PRD): AI 提示词（Prompt）版本管理与编辑工具**

**版本**: 1.0
**日期**: 2025年11月15日

#### 1. 产品概述

本项目旨在开发一款专注于 AI 提示词（Prompt）创作与优化的 Web 应用。它解决了 Prompt 工程师在日常工作中遇到的两大核心痛点：**版本迭代管理困难**和**编辑效率低下**。

本工具通过引入类 Git 的、可视化的版本与分支管理系统，以及一个为 Prompt 编辑量身定制的高效编辑器，帮助用户系统性地记录、对比和优化他们的每一个想法，从而极大地提升 Prompt Engineering 的效率和创造力。

产品核心为**本地优先 (Local-First)**，所有用户数据默认存储在用户自己的浏览器中，确保了数据的隐私性和应用的离线可用性。

#### 2. 核心设计思想

*   **可视化版本控制**: 将复杂的版本历史以直观的、从上到下的树状图呈现，让分支、迭代和对比一目了然。
*   **专业级编辑体验**: 提供一个不仅仅是文本框，而是具备高级搜索、智能选择和效率工具的专业编辑器。
*   **数据自主可控**: 用户数据归用户所有。支持完整的本地导入导出功能，并可通过 WebDAV 协议将数据备份到用户自己的云存储中。
*   **零后端依赖**: 核心功能不依赖中心化服务器，降低了部署和维护成本，并增强了数据隐私。

#### 3. 功能需求详述

##### 3.1. 项目与组织管理

此部分为应用的基础结构，通过左侧边栏进行管理。

*   **目录 (Folder)**:
    *   用户可以创建、重命名、删除目录。
    *   目录可以嵌套，形成树状结构。
    *   目录仅用于组织和归类项目，本身不包含其他属性。
*   **项目 (Project)**:
    *   项目是管理一套相关 Prompt 版本的顶层容器。
    *   **创建项目**: 用户可以创建新项目，项目必须属于某个目录。
    *   **项目属性**:
        *   **项目名**: 必填，字符串。
        *   **创建时间**: 自动记录，不可修改。
        *   **更新时间**: 项目内任何版本发生变化时自动更新。
        *   **标签 (可选)**: 用于分类和筛选，提供三类预设标签供用户选择：
            *   **模型**: 例如 GPT-4, Midjourney, Stable Diffusion 等。
            *   **平台**: 例如 OpenAI, Poe, ComfyUI 等。
            *   **类型**: 例如 对话, 图片生成, 视频生成 等。

##### 3.2. 版本树与可视化

当用户在左侧边栏点击一个项目后，主工作区将展示该项目的版本树。

*   **布局**: 所有版本以节点的形式，按照父子关系从上到下垂直排列。父子节点之间有连线，清晰展示演进路径和分支情况。
*   **节点信息**: 每个版本节点在图上应概要显示其部分内容、创建时间或关键信息。
*   **自动定位**: 打开一个项目时，视图应**自动滚动并定位到该项目内“更新时间”最新的那个版本节点上**。
*   **交互**:
    *   点击任一版本节点，将在右侧或指定区域的编辑器中加载其详细内容以供查看或编辑。
    *   节点上应有明确的交互按钮，用于执行删除、创建子版本、对比等操作。

##### 3.3. 核心版本操作

版本是数据的核心实体。

*   **版本属性**:
    *   **ID**: 全局唯一标识符。
    *   **父版本 ID**: 指向其来源版本，构成树状结构。
    *   **创建时间**: 版本首次创建时的时间戳。
    *   **更新时间**: 版本内容或元数据（评分、附件）被原地修改时的时间戳。
    *   **内容**: Prompt 的核心文本。
    *   **评分**: 用户可为版本打分（如1-5星）。
    *   **附件**: 用户可为版本附加图片或视频文件。
*   **创建版本**:
    *   **默认保存 (点击保存按钮 / `Ctrl+Enter`)**: 在当前选中版本的下方，创建一个新的子版本。如果当前版本已有子版本，则此操作会创建一个新分支。
*   **原地更新版本**:
    *   **特殊保存 (`Ctrl+Shift+Enter`)**: 仅当版本为叶子节点（没有子版本）时可用。此操作直接修改当前版本的内容，并更新其“更新时间”，不创建新版本。
*   **删除版本**:
    *   用户可以删除任意版本。
    *   如果删除的是一个中间版本，其所有子版本将自动链接到被删版本的父版本上，保证历史链的连续性。

##### 3.4. 提示词编辑器

提供一个强大的、嵌入式的文本编辑器。

*   **搜索功能**:
    *   支持在编辑器内进行文本搜索。
    *   支持多行文本搜索。
    *   支持正则表达式搜索。
*   **智能选择**:
    *   优化鼠标拖拽选择文本的逻辑。当用户从一个单词（对于字母语言）或汉字（对于中日韩语言）的中间开始拖动选择时，应智能地将整个词/字作为一个单元进行选中或取消选中，提供“吸附”效果。

##### 3.5. 版本对比 (Diff View)

*   用户可以选择树中的任意两个版本进行内容对比。
*   对比视图应采用**并排（Side-by-Side）**的布局。
*   视图中应清晰地高亮显示两个版本之间的**增加、删除和修改**的文本行或字符。

##### 3.6. 效率工具: Prompt 片段库 (Snippets)

*   应用需提供一个独立的“片段库”管理界面或侧边栏。
*   用户可以将常用的 Prompt 文本块（如画风描述、角色设定、前缀指令等）保存为片段。
*   用户可以对片段进行创建、命名、编辑和删除。
*   在编辑器中，用户可以通过点击或拖拽，快速将库中的片段插入到当前光标位置。

##### 3.7. 数据管理

*   **本地存储**: 所有项目和版本数据（包括附件的二进制内容）默认存储在用户浏览器的 IndexedDB 中。
*   **数据导出**:
    *   **导出为 JSON**: 导出一个纯文本文件，包含指定项目的所有版本数据（不含附件）。
    *   **导出为 ZIP**: 导出一个压缩包，其中包含一个 JSON 数据文件以及所有版本中附加的图片/视频原文件。
*   **数据导入**:
    *   支持从本地上传符合格式的 JSON 或 ZIP 文件，将其中的数据和附件完整地还原到应用中。
*   **WebDAV 备份与还原**:
    *   用户可以在设置中配置自己的 WebDAV 服务器地址和认证信息。
    *   提供“备份到 WebDAV”和“从 WebDAV 还原”的功能，支持 JSON 和 ZIP 两种格式。
